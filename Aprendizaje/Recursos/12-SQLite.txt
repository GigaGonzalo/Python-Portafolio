ğŸ Â¡SQLite PYTHON-O-MATIC! ğŸ

Â¡LLEGÃ“ LA REVOLUCIÃ“N EN BASES DE DATOS EMBEBIDAS!
ğŸ¯ Â¡SQLite EN PYTHON - PODER DE DATOS LOCAL!


# âš¡ Â¡BIENVENIDO AL MUNDO DE SQLite! âš¡
import sqlite3
import os

print("ğŸŠ Â¡SQLite PYTHON - ALMACENA DATOS COMO NUNCA! ğŸŠ")
print("Â¿Cansado de archivos de texto? Â¿Necesitas una base de datos real?")
print("Â¡SQLite lo resuelve TODO! ğŸ’«")

ğŸš€ Â¡CONCEPTOS BÃSICOS - TU PRIMERA BASE DE DATOS!
âœ¨ Â¿QUÃ‰ ES SQLite? - Â¡BASE DE DATOS EN UN ARCHIVO!
python

"""
Â¡SQLite ES INCREÃBLE!:

âœ… Base de datos relacional embebida
âœ… No requiere servidor - solo un archivo
âœ… Transacciones ACID completas
âœ… Soporte SQL estÃ¡ndar
âœ… Multiplataforma
âœ… Cero configuraciÃ³n
"""

# Â¡VENTAJAS PRINCIPALES!
print("ğŸ† Â¡VENTAJAS DE SQLite! ğŸ†")
print("ğŸ”¹ Archivo Ãºnico - FÃ¡cil de copiar y respaldar")
print("ğŸ”¹ Sin configuraciÃ³n - Listo para usar")
print("ğŸ”¹ Eficiente - Perfecto para aplicaciones locales")
print("ğŸ”¹ Confiable - Transacciones ACID")
print("ğŸ”¹ Portable - Mismo archivo en cualquier sistema")

# Â¡CASOS DE USO IDEALES!
print("\nğŸ¯ Â¡CASOS DE USO PERFECTOS! ğŸ¯")
print("ğŸ“± Aplicaciones mÃ³viles")
print("ğŸ–¥ï¸ Aplicaciones de escritorio")
print("ğŸŒ Sitios web de bajo trÃ¡fico")
print("ğŸ”§ Herramientas de desarrollo")
print("ğŸ“Š AnÃ¡lisis de datos local")

ğŸ”§ CONEXIÃ“N BÃSICA - Â¡PRIMER CONTACTO!
python

import sqlite3

print("ğŸ”Œ Â¡CONEXIÃ“N A SQLite! ğŸ”Œ")

# Â¡CONECTAR O CREAR BASE DE DATOS!
def crear_conexion(db_file):
    """Crea una conexiÃ³n a la base de datos SQLite"""
    try:
        conexion = sqlite3.connect(db_file)
        print(f"âœ… ConexiÃ³n exitosa a: {db_file}")
        return conexion
    except sqlite3.Error as e:
        print(f"âŒ Error al conectar: {e}")
        return None

# Â¡PRIMERA CONEXIÃ“N!
nombre_db = "mi_primera_base.db"
conexion = crear_conexion(nombre_db)

if conexion:
    # Â¡INFORMACIÃ“N DE LA CONEXIÃ“N!
    print(f"ğŸ“Š InformaciÃ³n de la base de datos:")
    print(f"   VersiÃ³n SQLite: {sqlite3.sqlite_version}")
    print(f"   Ruta: {os.path.abspath(nombre_db)}")
    print(f"   TamaÃ±o: {os.path.getsize(nombre_db)} bytes")
    
    # Â¡SIEMPRE CERRAR LA CONEXIÃ“N!
    conexion.close()
    print("ğŸ”’ ConexiÃ³n cerrada correctamente")

# Â¡ELIMINAR ARCHIVO DE DEMOSTRACIÃ“N!
if os.path.exists(nombre_db):
    os.remove(nombre_db)
    print("ğŸ§¹ Archivo de demostraciÃ³n eliminado")

ğŸ—ï¸ Â¡CREACIÃ“N DE TABLAS - ESTRUCTURA DE DATOS!
ğŸ“Š DISEÃ‘O DE TABLAS - Â¡PLANEA TU BASE DE DATOS!


import sqlite3

print("ğŸ—ï¸ Â¡CREANDO TABLAS EN SQLite! ğŸ—ï¸")

def crear_tablas(conexion):
    """Crea las tablas de la base de datos"""
    
    # Â¡SENTENCIAS SQL PARA CREAR TABLAS!
    sql_usuarios = """
    CREATE TABLE IF NOT EXISTS usuarios (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        nombre TEXT NOT NULL,
        email TEXT UNIQUE NOT NULL,
        edad INTEGER,
        fecha_registro DATETIME DEFAULT CURRENT_TIMESTAMP,
        activo BOOLEAN DEFAULT 1
    );
    """
    
    sql_productos = """
    CREATE TABLE IF NOT EXISTS productos (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        nombre TEXT NOT NULL,
        precio REAL NOT NULL,
        categoria TEXT,
        stock INTEGER DEFAULT 0,
        fecha_creacion DATETIME DEFAULT CURRENT_TIMESTAMP
    );
    """
    
    sql_pedidos = """
    CREATE TABLE IF NOT EXISTS pedidos (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        usuario_id INTEGER,
        producto_id INTEGER,
        cantidad INTEGER NOT NULL,
        total REAL NOT NULL,
        fecha_pedido DATETIME DEFAULT CURRENT_TIMESTAMP,
        estado TEXT DEFAULT 'pendiente',
        FOREIGN KEY (usuario_id) REFERENCES usuarios (id),
        FOREIGN KEY (producto_id) REFERENCES productos (id)
    );
    """
    
    try:
        cursor = conexion.cursor()
        
        # Ejecutar sentencias SQL
        cursor.execute(sql_usuarios)
        cursor.execute(sql_productos)
        cursor.execute(sql_pedidos)
        
        conexion.commit()
        print("âœ… Tablas creadas exitosamente!")
        
        # Mostrar tablas creadas
        cursor.execute("SELECT name FROM sqlite_master WHERE type='table';")
        tablas = cursor.fetchall()
        
        print("ğŸ“‹ Tablas en la base de datos:")
        for tabla in tablas:
            print(f"   ğŸ¯ {tabla[0]}")
            
    except sqlite3.Error as e:
        print(f"âŒ Error al crear tablas: {e}")

# Â¡DEMOSTRACIÃ“N!
nombre_db = "tienda.db"
conexion = sqlite3.connect(nombre_db)

crear_tablas(conexion)
conexion.close()

# Limpieza
if os.path.exists(nombre_db):
    os.remove(nombre_db)
    print("ğŸ§¹ Archivo de demostraciÃ³n eliminado")

ğŸ”„ Â¡CRUD COMPLETO - CREAR, LEER, ACTUALIZAR, ELIMINAR!
ğŸ“ INSERTAR DATOS - Â¡CREAR REGISTROS!


import sqlite3
from datetime import datetime

print("ğŸ“ Â¡INSERTANDO DATOS EN SQLite! ğŸ“")

def demo_insertar_datos():
    """Demuestra diferentes formas de insertar datos"""
    
    conexion = sqlite3.connect("crud_demo.db")
    cursor = conexion.cursor()
    
    # Crear tabla de ejemplo
    cursor.execute("""
    CREATE TABLE IF NOT EXISTS clientes (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        nombre TEXT NOT NULL,
        email TEXT UNIQUE,
        telefono TEXT,
        ciudad TEXT,
        fecha_registro DATETIME DEFAULT CURRENT_TIMESTAMP
    )
    """)
    
    print("ğŸ¯ MÃ‰TODOS DE INSERCIÃ“N:")
    
    # 1. INSERCIÃ“N SIMPLE
    print("\n1. ğŸ”¹ InserciÃ³n simple:")
    cursor.execute("INSERT INTO clientes (nombre, email, ciudad) VALUES (?, ?, ?)", 
                  ("Ana GarcÃ­a", "ana@python.com", "Madrid"))
    print("   âœ… Cliente Ana insertado")
    
    # 2. INSERCIÃ“N MÃšLTIPLE
    print("\n2. ğŸ”¹ InserciÃ³n mÃºltiple:")
    clientes = [
        ("Carlos LÃ³pez", "carlos@python.com", "Barcelona"),
        ("MarÃ­a RodrÃ­guez", "maria@python.com", "Valencia"),
        ("Pedro MartÃ­nez", "pedro@python.com", "Sevilla")
    ]
    cursor.executemany("INSERT INTO clientes (nombre, email, ciudad) VALUES (?, ?, ?)", clientes)
    print("   âœ… 3 clientes insertados")
    
    # 3. INSERCIÃ“N CON DATOS COMPLETOS
    print("\n3. ğŸ”¹ InserciÃ³n con datos completos:")
    cursor.execute("""
    INSERT INTO clientes (nombre, email, telefono, ciudad) 
    VALUES (?, ?, ?, ?)
    """, ("Laura FernÃ¡ndez", "laura@python.com", "+34 600 111 222", "Bilbao"))
    print("   âœ… Cliente Laura con telÃ©fono insertado")
    
    # 4. INSERCIÃ“N CON RETORNO DE ID
    print("\n4. ğŸ”¹ InserciÃ³n con retorno de ID:")
    cursor.execute("INSERT INTO clientes (nombre, email) VALUES (?, ?)", 
                  ("Sofia Castro", "sofia@python.com"))
    id_sofia = cursor.lastrowid
    print(f"   âœ… Cliente Sofia insertado con ID: {id_sofia}")
    
    conexion.commit()
    
    # Mostrar datos insertados
    print("\nğŸ“Š CLIENTES REGISTRADOS:")
    cursor.execute("SELECT id, nombre, email, ciudad FROM clientes")
    for cliente in cursor.fetchall():
        print(f"   ğŸ‘¤ ID: {cliente[0]}, {cliente[1]} - {cliente[2]} ({cliente[3]})")
    
    conexion.close()
    return "crud_demo.db"

# Ejecutar demostraciÃ³n
archivo_db = demo_insertar_datos()

# Limpieza
if os.path.exists(archivo_db):
    os.remove(archivo_db)
    print("ğŸ§¹ Archivo de demostraciÃ³n eliminado")

ğŸ” CONSULTAR DATOS - Â¡LEER REGISTROS!


import sqlite3

print("ğŸ” Â¡CONSULTANDO DATOS EN SQLite! ğŸ”")

def demo_consultas():
    """Demuestra diferentes tipos de consultas SQL"""
    
    conexion = sqlite3.connect("consultas_demo.db")
    cursor = conexion.cursor()
    
    # Crear datos de ejemplo
    cursor.execute("""
    CREATE TABLE IF NOT EXISTS empleados (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        nombre TEXT NOT NULL,
        departamento TEXT,
        salario REAL,
        fecha_contratacion DATE,
        activo BOOLEAN DEFAULT 1
    )
    """)
    
    # Insertar datos de ejemplo
    empleados = [
        ("Ana GarcÃ­a", "Ventas", 35000, "2022-01-15", 1),
        ("Carlos LÃ³pez", "TI", 45000, "2021-03-20", 1),
        ("MarÃ­a RodrÃ­guez", "Ventas", 32000, "2023-06-10", 1),
        ("Pedro MartÃ­nez", "Marketing", 38000, "2020-11-05", 0),
        ("Laura FernÃ¡ndez", "TI", 52000, "2019-08-12", 1),
        ("Sofia Castro", "RRHH", 41000, "2022-09-30", 1)
    ]
    
    cursor.executemany("""
    INSERT INTO empleados (nombre, departamento, salario, fecha_contratacion, activo)
    VALUES (?, ?, ?, ?, ?)
    """, empleados)
    conexion.commit()
    
    print("ğŸ¯ TIPOS DE CONSULTAS:")
    
    # 1. CONSULTA BÃSICA - TODOS LOS REGISTROS
    print("\n1. ğŸ“‹ Todos los empleados:")
    cursor.execute("SELECT * FROM empleados")
    empleados = cursor.fetchall()
    for emp in empleados:
        print(f"   ğŸ‘¤ {emp[1]} - {emp[2]} - ${emp[3]:,}")
    
    # 2. CONSULTA CON FILTROS
    print("\n2. ğŸ¯ Empleados de TI:")
    cursor.execute("SELECT nombre, salario FROM empleados WHERE departamento = ?", ("TI",))
    for emp in cursor.fetchall():
        print(f"   ğŸ’» {emp[0]} - ${emp[1]:,}")
    
    # 3. CONSULTA CON ORDENAMIENTO
    print("\n3. ğŸ“Š Empleados ordenados por salario (descendente):")
    cursor.execute("SELECT nombre, departamento, salario FROM empleados WHERE activo = 1 ORDER BY salario DESC")
    for emp in cursor.fetchall():
        print(f"   ğŸ’° {emp[0]} - {emp[1]} - ${emp[2]:,}")
    
    # 4. CONSULTA CON AGRUPAMIENTO
    print("\n4. ğŸ“ˆ Salario promedio por departamento:")
    cursor.execute("""
    SELECT departamento, COUNT(*) as cantidad, AVG(salario) as salario_promedio 
    FROM empleados 
    WHERE activo = 1 
    GROUP BY departamento
    """)
    for depto in cursor.fetchall():
        print(f"   ğŸ¢ {depto[0]}: {depto[1]} empleados - ${depto[2]:,.2f} promedio")
    
    # 5. CONSULTA CON LÃMITE
    print("\n5. ğŸ¥‡ Top 3 empleados mejor pagados:")
    cursor.execute("""
    SELECT nombre, departamento, salario 
    FROM empleados 
    WHERE activo = 1 
    ORDER BY salario DESC 
    LIMIT 3
    """)
    for emp in cursor.fetchall():
        print(f"   ğŸ‘‘ {emp[0]} - {emp[1]} - ${emp[2]:,}")
    
    # 6. CONSULTA CON BÃšSQUEDA DE TEXTO
    print("\n6. ğŸ” Empleados que contienen 'a' en el nombre:")
    cursor.execute("SELECT nombre FROM empleados WHERE nombre LIKE '%a%'")
    for emp in cursor.fetchall():
        print(f"   ğŸ” {emp[0]}")
    
    conexion.close()
    return "consultas_demo.db"

# Ejecutar demostraciÃ³n
archivo_db = demo_consultas()

# Limpieza
if os.path.exists(archivo_db):
    os.remove(archivo_db)
    print("ğŸ§¹ Archivo de demostraciÃ³n eliminado")

âœï¸ ACTUALIZAR DATOS - Â¡MODIFICAR REGISTROS!


import sqlite3

print("âœï¸ Â¡ACTUALIZANDO DATOS EN SQLite! âœï¸")

def demo_actualizaciones():
    """Demuestra diferentes formas de actualizar datos"""
    
    conexion = sqlite3.connect("actualizaciones_demo.db")
    cursor = conexion.cursor()
    
    # Crear tabla de productos
    cursor.execute("""
    CREATE TABLE IF NOT EXISTS productos (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        nombre TEXT NOT NULL,
        precio REAL NOT NULL,
        stock INTEGER DEFAULT 0,
        categoria TEXT,
        fecha_actualizacion DATETIME DEFAULT CURRENT_TIMESTAMP
    )
    """)
    
    # Insertar productos de ejemplo
    productos = [
        ("Laptop Gaming", 1299.99, 5, "ElectrÃ³nicos"),
        ("Mouse InalÃ¡mbrico", 25.50, 20, "ElectrÃ³nicos"),
        ("Teclado MecÃ¡nico", 89.99, 8, "ElectrÃ³nicos"),
        ("Silla Oficina", 199.99, 3, "Muebles"),
        ("Monitor 24\"", 299.99, 0, "ElectrÃ³nicos")
    ]
    
    cursor.executemany("INSERT INTO productos (nombre, precio, stock, categoria) VALUES (?, ?, ?, ?)", productos)
    conexion.commit()
    
    print("ğŸ”„ TIPOS DE ACTUALIZACIONES:")
    
    # Mostrar estado inicial
    print("\nğŸ“¦ ESTADO INICIAL DE PRODUCTOS:")
    cursor.execute("SELECT nombre, precio, stock FROM productos")
    for prod in cursor.fetchall():
        print(f"   ğŸ“ {prod[0]} - ${prod[1]} - Stock: {prod[2]}")
    
    # 1. ACTUALIZACIÃ“N SIMPLE
    print("\n1. ğŸ”¹ Actualizar precio del mouse:")
    cursor.execute("UPDATE productos SET precio = ? WHERE nombre = ?", (29.99, "Mouse InalÃ¡mbrico"))
    print("   âœ… Precio del mouse actualizado a $29.99")
    
    # 2. ACTUALIZACIÃ“N MÃšLTIPLE
    print("\n2. ğŸ”¹ Aplicar descuento del 10% a electrÃ³nicos:")
    cursor.execute("UPDATE productos SET precio = precio * 0.9 WHERE categoria = ?", ("ElectrÃ³nicos",))
    print("   âœ… Descuento aplicado a productos electrÃ³nicos")
    
    # 3. ACTUALIZACIÃ“N CON CÃLCULOS
    print("\n3. ğŸ”¹ Reponer stock de productos agotados:")
    cursor.execute("UPDATE productos SET stock = stock + 10 WHERE stock = 0")
    print("   âœ… Stock repuesto para productos agotados")
    
    # 4. ACTUALIZACIÃ“N CONDICIONAL COMPLEJA
    print("\n4. ğŸ”¹ Incrementar precio de productos con poco stock:")
    cursor.execute("""
    UPDATE productos 
    SET precio = precio * 1.05, 
        fecha_actualizacion = CURRENT_TIMESTAMP 
    WHERE stock < 5 AND stock > 0
    """)
    print("   âœ… Precio incrementado para productos con stock bajo")
    
    conexion.commit()
    
    # Mostrar estado final
    print("\nğŸ“¦ ESTADO FINAL DE PRODUCTOS:")
    cursor.execute("SELECT nombre, precio, stock FROM productos ORDER BY nombre")
    for prod in cursor.fetchall():
        print(f"   âœ… {prod[0]} - ${prod[1]:.2f} - Stock: {prod[2]}")
    
    conexion.close()
    return "actualizaciones_demo.db"

# Ejecutar demostraciÃ³n
archivo_db = demo_actualizaciones()

# Limpieza
if os.path.exists(archivo_db):
    os.remove(archivo_db)
    print("ğŸ§¹ Archivo de demostraciÃ³n eliminado")

ğŸ—‘ï¸ ELIMINAR DATOS - Â¡BORRAR REGISTROS!


import sqlite3

print("ğŸ—‘ï¸ Â¡ELIMINANDO DATOS EN SQLite! ğŸ—‘ï¸")

def demo_eliminaciones():
    """Demuestra diferentes formas de eliminar datos"""
    
    conexion = sqlite3.connect("eliminaciones_demo.db")
    cursor = conexion.cursor()
    
    # Crear tabla de usuarios
    cursor.execute("""
    CREATE TABLE IF NOT EXISTS usuarios (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        username TEXT UNIQUE NOT NULL,
        email TEXT UNIQUE NOT NULL,
        fecha_registro DATETIME DEFAULT CURRENT_TIMESTAMP,
        ultimo_login DATETIME,
        activo BOOLEAN DEFAULT 1
    )
    """)
    
    # Insertar usuarios de ejemplo
    usuarios = [
        ("ana_dev", "ana@python.com", "2023-01-15", "2024-01-10"),
        ("carlos_data", "carlos@python.com", "2023-03-20", "2023-12-05"),
        ("maria_ai", "maria@python.com", "2023-06-10", "2024-01-12"),
        ("pedro_cloud", "pedro@python.com", "2022-11-05", "2023-08-15"),
        ("laura_web", "laura@python.com", "2023-09-30", "2024-01-14"),
        ("sofia_mobile", "sofia@python.com", "2022-08-12", "2023-05-20")
    ]
    
    cursor.executemany("INSERT INTO usuarios (username, email, fecha_registro, ultimo_login) VALUES (?, ?, ?, ?)", usuarios)
    conexion.commit()
    
    print("âš ï¸ TIPOS DE ELIMINACIÃ“N:")
    
    # Mostrar estado inicial
    print("\nğŸ‘¥ USUARIOS REGISTRADOS:")
    cursor.execute("SELECT username, email, ultimo_login FROM usuarios")
    for usuario in cursor.fetchall():
        print(f"   ğŸ‘¤ {usuario[0]} - {usuario[1]} - Ãšltimo login: {usuario[2]}")
    
    # 1. ELIMINACIÃ“N POR CONDICIÃ“N
    print("\n1. ğŸ”¹ Eliminar usuarios inactivos (Ãºltimo login antes de 2024):")
    cursor.execute("DELETE FROM usuarios WHERE ultimo_login < '2024-01-01'")
    eliminados = cursor.rowcount
    print(f"   âœ… {eliminados} usuarios eliminados por inactividad")
    
    # 2. ELIMINACIÃ“N POR ID ESPECÃFICO
    print("\n2. ğŸ”¹ Eliminar usuario especÃ­fico:")
    # Primero obtener un ID para eliminar
    cursor.execute("SELECT id, username FROM usuarios LIMIT 1")
    usuario_a_eliminar = cursor.fetchone()
    
    if usuario_a_eliminar:
        cursor.execute("DELETE FROM usuarios WHERE id = ?", (usuario_a_eliminar[0],))
        print(f"   âœ… Usuario '{usuario_a_eliminar[1]}' eliminado")
    
    # 3. ELIMINACIÃ“N CON TRANSACCIÃ“N Y VERIFICACIÃ“N
    print("\n3. ğŸ”¹ EliminaciÃ³n segura con transacciÃ³n:")
    try:
        # Iniciar transacciÃ³n explÃ­cita
        conexion.execute("BEGIN TRANSACTION")
        
        # Verificar antes de eliminar
        cursor.execute("SELECT COUNT(*) FROM usuarios WHERE username = 'maria_ai'")
        existe = cursor.fetchone()[0]
        
        if existe > 0:
            cursor.execute("DELETE FROM usuarios WHERE username = 'maria_ai'")
            print("   âœ… Usuario 'maria_ai' eliminado en transacciÃ³n")
        else:
            print("   â„¹ï¸ Usuario 'maria_ai' no existe")
        
        # Confirmar transacciÃ³n
        conexion.commit()
        
    except sqlite3.Error as e:
        # Revertir en caso de error
        conexion.rollback()
        print(f"   âŒ Error en transacciÃ³n: {e}")
    
    # 4. ELIMINACIÃ“N DE TODOS LOS REGISTROS (CUIDADO!)
    print("\n4. ğŸ”¹ Eliminar todos los registros (TRUNCATE):")
    confirmacion = input("   Â¿EstÃ¡s seguro de eliminar TODOS los usuarios? (s/n): ")
    
    if confirmacion.lower() == 's':
        cursor.execute("DELETE FROM usuarios")
        print("   âœ… Todos los usuarios eliminados")
        conexion.commit()
    else:
        print("   âŒ EliminaciÃ³n cancelada")
    
    # Mostrar estado final
    print("\nğŸ‘¥ USUARIOS RESTANTES:")
    cursor.execute("SELECT username, email FROM usuarios")
    usuarios_restantes = cursor.fetchall()
    
    if usuarios_restantes:
        for usuario in usuarios_restantes:
            print(f"   âœ… {usuario[0]} - {usuario[1]}")
    else:
        print("   ğŸ“­ No hay usuarios en la base de datos")
    
    conexion.close()
    return "eliminaciones_demo.db"

# Ejecutar demostraciÃ³n
archivo_db = demo_eliminaciones()

# Limpieza
if os.path.exists(archivo_db):
    os.remove(archivo_db)
    print("ğŸ§¹ Archivo de demostraciÃ³n eliminado")

âš¡ Â¡TRANSACCIONES - SEGURIDAD Y CONSISTENCIA!
ğŸ”’ TRANSACCIONES ACID - Â¡DATOS SEGUROS!


import sqlite3

print("ğŸ”’ Â¡TRANSACCIONES EN SQLite! ğŸ”’")

def demo_transacciones():
    """Demuestra el uso de transacciones para operaciones seguras"""
    
    conexion = sqlite3.connect("transacciones_demo.db")
    cursor = conexion.cursor()
    
    # Crear tablas para sistema bancario
    cursor.execute("""
    CREATE TABLE IF NOT EXISTS cuentas (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        numero_cuenta TEXT UNIQUE NOT NULL,
        titular TEXT NOT NULL,
        saldo REAL DEFAULT 0.0,
        fecha_creacion DATETIME DEFAULT CURRENT_TIMESTAMP
    )
    """)
    
    cursor.execute("""
    CREATE TABLE IF NOT EXISTS transacciones (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        cuenta_origen TEXT,
        cuenta_destino TEXT,
        monto REAL NOT NULL,
        tipo TEXT NOT NULL,
        fecha DATETIME DEFAULT CURRENT_TIMESTAMP,
        descripcion TEXT
    )
    """)
    
    # Crear cuentas de ejemplo
    cuentas = [
        ("CUENTA-001", "Ana GarcÃ­a", 1000.0),
        ("CUENTA-002", "Carlos LÃ³pez", 500.0)
    ]
    
    cursor.executemany("INSERT INTO cuentas (numero_cuenta, titular, saldo) VALUES (?, ?, ?)", cuentas)
    conexion.commit()
    
    print("ğŸ¦ SISTEMA BANCARIO CON TRANSACCIONES")
    
    def transferir_dinero(cuenta_origen, cuenta_destino, monto):
        """Realiza una transferencia segura usando transacciones"""
        try:
            # Iniciar transacciÃ³n
            conexion.execute("BEGIN TRANSACTION")
            
            print(f"\nğŸ”„ Iniciando transferencia: ${monto} de {cuenta_origen} a {cuenta_destino}")
            
            # 1. Verificar fondos en cuenta origen
            cursor.execute("SELECT saldo FROM cuentas WHERE numero_cuenta = ?", (cuenta_origen,))
            saldo_origen = cursor.fetchone()[0]
            
            if saldo_origen < monto:
                raise ValueError("âŒ Fondos insuficientes")
            
            # 2. Restar de cuenta origen
            cursor.execute("UPDATE cuentas SET saldo = saldo - ? WHERE numero_cuenta = ?", (monto, cuenta_origen))
            print(f"   âœ… ${monto} debitados de {cuenta_origen}")
            
            # 3. Sumar a cuenta destino
            cursor.execute("UPDATE cuentas SET saldo = saldo + ? WHERE numero_cuenta = ?", (monto, cuenta_destino))
            print(f"   âœ… ${monto} acreditados a {cuenta_destino}")
            
            # 4. Registrar transacciÃ³n
            cursor.execute("""
            INSERT INTO transacciones (cuenta_origen, cuenta_destino, monto, tipo, descripcion)
            VALUES (?, ?, ?, ?, ?)
            """, (cuenta_origen, cuenta_destino, monto, "transferencia", f"Transferencia a {cuenta_destino}"))
            
            # Confirmar transacciÃ³n
            conexion.commit()
            print("   ğŸ‰ Transferencia completada exitosamente!")
            return True
            
        except Exception as e:
            # Revertir en caso de error
            conexion.rollback()
            print(f"   ğŸ’¥ Error: {e}")
            print("   ğŸ”„ TransacciÃ³n revertida - No se realizaron cambios")
            return False
    
    def mostrar_saldos():
        """Muestra los saldos actuales"""
        print("\nğŸ’° SALDOS ACTUALES:")
        cursor.execute("SELECT numero_cuenta, titular, saldo FROM cuentas")
        for cuenta in cursor.fetchall():
            print(f"   ğŸ‘¤ {cuenta[1]} ({cuenta[0]}): ${cuenta[2]:.2f}")
    
    # Mostrar saldos iniciales
    print("\nğŸ“Š ESTADO INICIAL:")
    mostrar_saldos()
    
    # Realizar transferencias
    print("\n" + "="*50)
    
    # Transferencia exitosa
    transferir_dinero("CUENTA-001", "CUENTA-002", 200.0)
    
    # Mostrar saldos despuÃ©s de transferencia exitosa
    mostrar_saldos()
    
    print("\n" + "="*50)
    
    # Transferencia fallida (fondos insuficientes)
    transferir_dinero("CUENTA-002", "CUENTA-001", 1000.0)
    
    # Mostrar saldos finales (no deberÃ­an cambiar por la transacciÃ³n fallida)
    print("\nğŸ“Š ESTADO FINAL:")
    mostrar_saldos()
    
    # Mostrar historial de transacciones
    print("\nğŸ“‹ HISTORIAL DE TRANSACCIONES:")
    cursor.execute("SELECT cuenta_origen, cuenta_destino, monto, fecha FROM transacciones")
    for trans in cursor.fetchall():
        print(f"   ğŸ’¸ {trans[0]} â†’ {trans[1]}: ${trans[2]} - {trans[3]}")
    
    conexion.close()
    return "transacciones_demo.db"

# Ejecutar demostraciÃ³n
archivo_db = demo_transacciones()

# Limpieza
if os.path.exists(archivo_db):
    os.remove(archivo_db)
    print("ğŸ§¹ Archivo de demostraciÃ³n eliminado")

ğŸ† Â¡SISTEMA COMPLETO DEL MUNDO REAL!
ğŸ“š SISTEMA DE BIBLIOTECA CON SQLite


import sqlite3
import os
from datetime import datetime, timedelta

class SistemaBiblioteca:
    """Sistema completo de gestiÃ³n de biblioteca usando SQLite"""
    
    def __init__(self, db_nombre="biblioteca.db"):
        self.db_nombre = db_nombre
        self.conexion = None
        self.conectar()
        self.crear_tablas()
    
    def conectar(self):
        """Establece conexiÃ³n con la base de datos"""
        try:
            self.conexion = sqlite3.connect(self.db_nombre)
            # Configurar para devolver diccionarios en lugar de tuplas
            self.conexion.row_factory = sqlite3.Row
            print(f"âœ… Conectado a {self.db_nombre}")
        except sqlite3.Error as e:
            print(f"âŒ Error al conectar: {e}")
    
    def crear_tablas(self):
        """Crea las tablas necesarias para el sistema"""
        tablas_sql = [
            # Tabla de libros
            """
            CREATE TABLE IF NOT EXISTS libros (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                titulo TEXT NOT NULL,
                autor TEXT NOT NULL,
                isbn TEXT UNIQUE,
                genero TEXT,
                aÃ±o_publicacion INTEGER,
                ejemplares_totales INTEGER DEFAULT 1,
                ejemplares_disponibles INTEGER DEFAULT 1,
                fecha_agregado DATETIME DEFAULT CURRENT_TIMESTAMP
            )
            """,
            # Tabla de usuarios
            """
            CREATE TABLE IF NOT EXISTS usuarios (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                nombre TEXT NOT NULL,
                email TEXT UNIQUE NOT NULL,
                telefono TEXT,
                fecha_registro DATETIME DEFAULT CURRENT_TIMESTAMP,
                activo BOOLEAN DEFAULT 1
            )
            """,
            # Tabla de prÃ©stamos
            """
            CREATE TABLE IF NOT EXISTS prestamos (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                libro_id INTEGER NOT NULL,
                usuario_id INTEGER NOT NULL,
                fecha_prestamo DATETIME DEFAULT CURRENT_TIMESTAMP,
                fecha_devolucion_estimada DATETIME,
                fecha_devolucion_real DATETIME,
                estado TEXT DEFAULT 'prestado',
                FOREIGN KEY (libro_id) REFERENCES libros (id),
                FOREIGN KEY (usuario_id) REFERENCES usuarios (id)
            )
            """
        ]
        
        try:
            cursor = self.conexion.cursor()
            for tabla_sql in tablas_sql:
                cursor.execute(tabla_sql)
            self.conexion.commit()
            print("âœ… Tablas creadas/verificadas correctamente")
        except sqlite3.Error as e:
            print(f"âŒ Error al crear tablas: {e}")
    
    def agregar_libro(self, titulo, autor, isbn=None, genero=None, aÃ±o=None, ejemplares=1):
        """Agrega un nuevo libro a la biblioteca"""
        try:
            cursor = self.conexion.cursor()
            cursor.execute("""
            INSERT INTO libros (titulo, autor, isbn, genero, aÃ±o_publicacion, ejemplares_totales, ejemplares_disponibles)
            VALUES (?, ?, ?, ?, ?, ?, ?)
            """, (titulo, autor, isbn, genero, aÃ±o, ejemplares, ejemplares))
            
            self.conexion.commit()
            print(f"âœ… Libro '{titulo}' agregado exitosamente")
            return cursor.lastrowid
        except sqlite3.IntegrityError:
            print("âŒ Error: ISBN ya existe")
            return None
        except sqlite3.Error as e:
            print(f"âŒ Error al agregar libro: {e}")
            return None
    
    def registrar_usuario(self, nombre, email, telefono=None):
        """Registra un nuevo usuario en el sistema"""
        try:
            cursor = self.conexion.cursor()
            cursor.execute("""
            INSERT INTO usuarios (nombre, email, telefono)
            VALUES (?, ?, ?)
            """, (nombre, email, telefono))
            
            self.conexion.commit()
            print(f"âœ… Usuario '{nombre}' registrado exitosamente")
            return cursor.lastrowid
        except sqlite3.IntegrityError:
            print("âŒ Error: Email ya registrado")
            return None
        except sqlite3.Error as e:
            print(f"âŒ Error al registrar usuario: {e}")
            return None
    
    def prestar_libro(self, libro_id, usuario_id, dias_prestamo=14):
        """Realiza el prÃ©stamo de un libro"""
        try:
            cursor = self.conexion.cursor()
            
            # Verificar disponibilidad
            cursor.execute("SELECT ejemplares_disponibles FROM libros WHERE id = ?", (libro_id,))
            libro = cursor.fetchone()
            
            if not libro or libro['ejemplares_disponibles'] <= 0:
                print("âŒ Libro no disponible para prÃ©stamo")
                return False
            
            # Calcular fecha de devoluciÃ³n estimada
            fecha_devolucion = datetime.now() + timedelta(days=dias_prestamo)
            
            # Registrar prÃ©stamo
            cursor.execute("""
            INSERT INTO prestamos (libro_id, usuario_id, fecha_devolucion_estimada)
            VALUES (?, ?, ?)
            """, (libro_id, usuario_id, fecha_devolucion))
            
            # Actualizar disponibilidad
            cursor.execute("""
            UPDATE libros 
            SET ejemplares_disponibles = ejemplares_disponibles - 1 
            WHERE id = ?
            """, (libro_id,))
            
            self.conexion.commit()
            print("âœ… PrÃ©stamo registrado exitosamente")
            return True
            
        except sqlite3.Error as e:
            self.conexion.rollback()
            print(f"âŒ Error en prÃ©stamo: {e}")
            return False
    
    def devolver_libro(self, prestamo_id):
        """Registra la devoluciÃ³n de un libro"""
        try:
            cursor = self.conexion.cursor()
            
            # Obtener informaciÃ³n del prÃ©stamo
            cursor.execute("SELECT libro_id FROM prestamos WHERE id = ? AND estado = 'prestado'", (prestamo_id,))
            prestamo = cursor.fetchone()
            
            if not prestamo:
                print("âŒ PrÃ©stamo no encontrado o ya devuelto")
                return False
            
            # Actualizar prÃ©stamo
            cursor.execute("""
            UPDATE prestamos 
            SET estado = 'devuelto', fecha_devolucion_real = CURRENT_TIMESTAMP 
            WHERE id = ?
            """, (prestamo_id,))
            
            # Actualizar disponibilidad del libro
            cursor.execute("""
            UPDATE libros 
            SET ejemplares_disponibles = ejemplares_disponibles + 1 
            WHERE id = ?
            """, (prestamo['libro_id'],))
            
            self.conexion.commit()
            print("âœ… DevoluciÃ³n registrada exitosamente")
            return True
            
        except sqlite3.Error as e:
            self.conexion.rollback()
            print(f"âŒ Error en devoluciÃ³n: {e}")
            return False
    
    def buscar_libros(self, criterio, valor):
        """Busca libros por diferentes criterios"""
        try:
            cursor = self.conexion.cursor()
            
            if criterio == "titulo":
                cursor.execute("SELECT * FROM libros WHERE titulo LIKE ?", (f'%{valor}%',))
            elif criterio == "autor":
                cursor.execute("SELECT * FROM libros WHERE autor LIKE ?", (f'%{valor}%',))
            elif criterio == "genero":
                cursor.execute("SELECT * FROM libros WHERE genero = ?", (valor,))
            elif criterio == "disponibles":
                cursor.execute("SELECT * FROM libros WHERE ejemplares_disponibles > 0")
            else:
                print("âŒ Criterio de bÃºsqueda no vÃ¡lido")
                return []
            
            return cursor.fetchall()
            
        except sqlite3.Error as e:
            print(f"âŒ Error en bÃºsqueda: {e}")
            return []
    
    def generar_reporte(self):
        """Genera un reporte completo del estado de la biblioteca"""
        try:
            cursor = self.conexion.cursor()
            
            print("\nğŸ“Š REPORTE DE BIBLIOTECA")
            print("=" * 50)
            
            # EstadÃ­sticas generales
            cursor.execute("SELECT COUNT(*) as total FROM libros")
            total_libros = cursor.fetchone()['total']
            
            cursor.execute("SELECT COUNT(*) as total FROM usuarios WHERE activo = 1")
            total_usuarios = cursor.fetchone()['total']
            
            cursor.execute("SELECT COUNT(*) as total FROM prestamos WHERE estado = 'prestado'")
            prestamos_activos = cursor.fetchone()['total']
            
            print(f"ğŸ“š Total libros: {total_libros}")
            print(f"ğŸ‘¥ Usuarios activos: {total_usuarios}")
            print(f"ğŸ“– PrÃ©stamos activos: {prestamos_activos}")
            
            # Libros mÃ¡s prestados
            print("\nğŸ”¥ LIBROS MÃS POPULARES:")
            cursor.execute("""
            SELECT l.titulo, l.autor, COUNT(p.id) as veces_prestado
            FROM libros l
            LEFT JOIN prestamos p ON l.id = p.libro_id
            GROUP BY l.id
            ORDER BY veces_prestado DESC
            LIMIT 5
            """)
            
            for libro in cursor.fetchall():
                print(f"   ğŸ“– {libro['titulo']} - {libro['autor']} ({libro['veces_prestado']} prÃ©stamos)")
            
            # PrÃ©stamos vencidos
            print("\nâš ï¸ PRÃ‰STAMOS VENCIDOS:")
            cursor.execute("""
            SELECT p.id, l.titulo, u.nombre, p.fecha_devolucion_estimada
            FROM prestamos p
            JOIN libros l ON p.libro_id = l.id
            JOIN usuarios u ON p.usuario_id = u.id
            WHERE p.estado = 'prestado' AND p.fecha_devolucion_estimada < DATE('now')
            """)
            
            prestamos_vencidos = cursor.fetchall()
            if prestamos_vencidos:
                for prestamo in prestamos_vencidos:
                    print(f"   âŒ {prestamo['titulo']} - {prestamo['nombre']} (Vencido: {prestamo['fecha_devolucion_estimada']})")
            else:
                print("   âœ… No hay prÃ©stamos vencidos")
                
        except sqlite3.Error as e:
            print(f"âŒ Error al generar reporte: {e}")
    
    def cerrar(self):
        """Cierra la conexiÃ³n con la base de datos"""
        if self.conexion:
            self.conexion.close()
            print("ğŸ”’ ConexiÃ³n cerrada")

# Â¡DEMOSTRACIÃ“N DEL SISTEMA!
def demostrar_sistema_biblioteca():
    """Demuestra el funcionamiento completo del sistema de biblioteca"""
    
    print("ğŸ›ï¸ SISTEMA DE BIBLIOTECA CON SQLite")
    print("=" * 60)
    
    # Crear sistema
    biblioteca = SistemaBiblioteca("demo_biblioteca.db")
    
    # Agregar libros
    print("\nğŸ“š AGREGANDO LIBROS:")
    biblioteca.agregar_libro("Cien aÃ±os de soledad", "Gabriel GarcÃ­a MÃ¡rquez", "978-8437604947", "Realismo mÃ¡gico", 1967, 3)
    biblioteca.agregar_libro("1984", "George Orwell", "978-0451524935", "Ciencia ficciÃ³n", 1949, 2)
    biblioteca.agregar_libro("El Quijote", "Miguel de Cervantes", "978-8424117896", "ClÃ¡sico", 1605, 1)
    biblioteca.agregar_libro("Python Crash Course", "Eric Matthes", "978-1593279288", "ProgramaciÃ³n", 2019, 5)
    
    # Registrar usuarios
    print("\nğŸ‘¥ REGISTRANDO USUARIOS:")
    biblioteca.registrar_usuario("Ana GarcÃ­a", "ana@email.com", "+34 600 111 222")
    biblioteca.registrar_usuario("Carlos LÃ³pez", "carlos@email.com", "+34 600 333 444")
    
    # Buscar libros
    print("\nğŸ” BUSCANDO LIBROS DE PROGRAMACIÃ“N:")
    libros_programacion = biblioteca.buscar_libros("genero", "ProgramaciÃ³n")
    for libro in libros_programacion:
        print(f"   ğŸ’» {libro['titulo']} - {libro['autor']} ({libro['ejemplares_disponibles']} disponibles)")
    
    # Realizar prÃ©stamos
    print("\nğŸ“– REALIZANDO PRÃ‰STAMOS:")
    biblioteca.prestar_libro(1, 1)  # Ana pide Cien aÃ±os de soledad
    biblioteca.prestar_libro(4, 2)  # Carlos pide Python Crash Course
    
    # Generar reporte
    biblioteca.generar_reporte()
    
    # Devolver un libro
    print("\nğŸ“š DEVOLVIENDO LIBRO:")
    biblioteca.devolver_libro(1)
    
    # Reporte final
    print("\nğŸ“Š ESTADO FINAL:")
    biblioteca.generar_reporte()
    
    # Cerrar sistema
    biblioteca.cerrar()
    
    return "demo_biblioteca.db"

# Ejecutar demostraciÃ³n
archivo_db = demostrar_sistema_biblioteca()

# Limpieza
if os.path.exists(archivo_db):
    os.remove(archivo_db)
    print("ğŸ§¹ Archivo de demostraciÃ³n eliminado")

ğŸŠ Â¡RESUMEN FINAL DE SQLite!

Â¿QUÃ‰ OBTIENES CON SQLite EN PYTHON?

    âœ… Base de datos embebida - Sin servidor, solo archivo

    âœ… Transacciones ACID - Datos seguros y consistentes

    âœ… SQL completo - Todas las operaciones estÃ¡ndar

    âœ… Alto rendimiento - Optimizado para aplicaciones locales

    âœ… Multiplataforma - Mismo archivo en cualquier sistema

Â¡OPERACIONES PRINCIPALES!

    ğŸ”Œ sqlite3.connect() - Conectar/crear base de datos

    ğŸ“Š cursor.execute() - Ejecutar consultas SQL

    ğŸ’¾ connection.commit() - Guardar cambios

    ğŸ”„ connection.rollback() - Revertir cambios

    ğŸ“¥ cursor.fetchall() - Obtener resultados

Â¡VENTAJAS CLAVE!

    ğŸš€ Cero configuraciÃ³n - Listo para usar

    ğŸ’¾ Archivo Ãºnico - FÃ¡cil de respaldar

    ğŸ”’ Transacciones - Operaciones seguras

    ğŸŒ Portable - Funciona en cualquier lugar

    âš¡ Eficiente - Perfecto para aplicaciones locales

Â¡NO ESPERES MÃS! â°
Â¡DOMINA SQLite Y CREA APLICACIONES CON DATOS PROFESIONALES!


import sqlite3

def demostrar_poder_final():
    """Â¡FunciÃ³n final que demuestra todo tu poder con SQLite!"""
    
    # Crear base de datos en memoria (solo para demostraciÃ³n)
    conexion = sqlite3.connect(":memory:")
    conexion.row_factory = sqlite3.Row
    
    # Crear tabla de logros
    conexion.execute("""
    CREATE TABLE logros_sqlite (
        id INTEGER PRIMARY KEY,
        habilidad TEXT,
        nivel TEXT,
        descripcion TEXT
    )
    """)
    
    # Insertar logros
    logros = [
        ("ConexiÃ³n y creaciÃ³n", "Avanzado", "Crear y gestionar bases de datos SQLite"),
        ("Operaciones CRUD", "Experto", "Insertar, consultar, actualizar y eliminar datos"),
        ("Transacciones", "Profesional", "Manejar transacciones ACID complejas"),
        ("Consultas avanzadas", "Maestro", "JOIN, GROUP BY, subconsultas"),
        ("Sistemas completos", "Arquitecto", "DiseÃ±ar sistemas empresariales con SQLite")
    ]
    
    conexion.executemany("INSERT INTO logros_sqlite (habilidad, nivel, descripcion) VALUES (?, ?, ?)", logros)
    conexion.commit()
    
    # Mostrar logros
    print("ğŸ‰ Â¡FELICIDADES! Ahora dominas:")
    print("ğŸ SQLite EN PYTHON - BASES DE DATOS PROFESIONALES")
    print("\nğŸ† TUS LOGROS:")
    
    cursor = conexion.execute("SELECT * FROM logros_sqlite ORDER BY id")
    for logro in cursor:
        print(f"   âœ… {logro['habilidad']} - Nivel {logro['nivel']}")
        print(f"      ğŸ“ {logro['descripcion']}")
    
    conexion.close()
    
    return "ğŸš€ Â¡EstÃ¡s listo para crear aplicaciones con bases de datos reales!"

# Â¡EJECUTA TU PODER!
mensaje_final = demostrar_poder_final()
print(f"\n{mensaje_final}")

Â¡SQLite ES LA BASE DE DATOS EMBEBIDA MÃS PODEROSA, Y AHORA LA CONTROLAS CON PYTHON! ğŸ’ªğŸ